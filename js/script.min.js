class Asteroid{constructor(t,s,e,i,o,a,n,h,r,c,d,u,p){this.id=t,this.title=s,this.width=e,this.height=i,this.x=o,this.y=a,this.xv=n,this.yv=h,this.color=r,this.type=c,this.oob=d,this.points=u,this.gravity=.1,this.gravitySpeed=0,this.bounce=.4,this.exists=!0,this.resetGravity=function(){},this.newPos=function(){this.gravitySpeed+=this.gravity,this.x+=this.xvel;var t=this.yv;this.yv<0&&(t=0),t=0,this.y+=t+this.gravitySpeed,this.hitBottom()},this.hitBottom=function(){var t=window.innerHeight-this.height;this.y>t&&(this.x=t,this.gravitySpeed=-this.gravitySpeed*this.bounce),this.x>window.innerWidth+this.width&&(this.x=0-this.width),this.x<0-this.width&&(this.x=window.innerWidth+this.width)},this.changeColor=function(t){this.color=t},this.oob=function(t){this.oob=t},this.changeVelocity=function(t,s){"x"==t&&(this.xv=s),"y"==t&&(this.yv=s)},this.changePosition=function(t,s){this.x=t,this.y=s},this.getVelocity=function(t){return this.direction},this.changeExistance=function(t){this.exists=t},this.destroy=function(){}}}class Spaceship{constructor(t,s,e,i,o,a,n,h){this.x=t,this.y=s,this.vx=e,this.vy=i,this.theta=o,this.width=20,this.height=15,this.yaw=a,this.x_points=n,this.y_points=h,this.shape="14.383032,5.9181762 0.35137621,0.04626516 2.7568063,5.9181762 0.35137621,11.338401",this.destroy=function(){}}}class Shot{constructor(t,s,e,i,o,a,n,h,r,c){this.id=t,this.x=s,this.y=e,this.vx=i,this.vy=o,this.theta=a,this.width=6,this.height=6,this.yaw=n,this.life=h,this.x_points=r,this.y_points=c,this.changePosition=function(t,s){this.x=t,this.y=s},this.changeLife=function(t){this.life=t},this.destroy=function(){}}}class Sound{constructor(t){this.sound=document.createElement("audio"),this.sound.src=t,this.sound.setAttribute("preload","auto"),this.sound.setAttribute("controls","none"),this.sound.style.display="none",document.body.appendChild(this.sound),this.play=function(){this.sound.play()},this.stop=function(){this.sound.pause()}}}class Ufo{constructor(t,s,e,i,o,a,n){this.x=t,this.y=s,this.vx=e,this.vy=i,this.theta=o,this.width=52,this.height=42,this.yaw=a,this.points=n,this.changePosition=function(t,s){this.x=t,this.y=s}}}class SpawnBox{constructor(t,s){this.x=t,this.y=s,this.width=100,this.height=100}}let asteroids=[],shots=[],shotCnt=0,xLimit=resetWindowLimit("x")-1,yLimit=resetWindowLimit("y")-1,spaceship=new Spaceship(xLimit/2,yLimit/2,0,0,0,0,0,0),colors=["#edc951","#eb6841","#cc2a36","#4f372d","#00a0b0"],rocksLrg=["26.087899,1.0434852 49.503787,26.009091 74.220561,2.6541843 96.335572,25.203747 85.278067,50.974686 98.286898,75.940275 62.512619,99.295186 26.087905,100.10053 0.7206885,77.55096 1.3711312,27.619771","27.46638,2.6445482 66.467442,0.98983643 99.048213,24.999426 V 35.822504 L 65.202598,51.325844 98.421452,73.55696 76.484471,97.835645 H 72.723845 L 60.501821,85.842551 27.596351,98.713169 0.95859607,63.02645 1.8987487,25.29194 H 36.997914","14.670645,48.844427 1.9670478,25.614646 27.37424,2.3848478 48.335078,12.875719 73.107033,1.6354928 97.878992,24.865291 75.012591,39.102909 97.878992,60.834007 75.012591,97.552066 39.442599,87.061197 26.739004,99.050766 1.3318868,75.820971"],spawnBox=new SpawnBox(xLimit/2-50,yLimit/2-50),lifeCnt=3,jumpCnt=3,score=0,newLifeTarget=1e4,newLife=newLifeTarget,resetGun=!0,inPlay=!1,mode="asteroids",rockCnt=10,scale=1,rockID=0,ufo=new Ufo(-100,-100,0,0,0,0,200),nextEnemy=Math.floor(1e3*getRandomFloat(10,30)),enemyDelay=2e3,enemyUFO=[],ufoShots=[],ufoShotCnt=0,ufoActive=!1,delta_time=20,turn=0,thrust=0,turn_per_milli=.1,thrust_per_milli=15e-5,key_delay=50,del_v=0,del_vx=0,del_vy=0,rock_max_v=1.5,shootsnd=null,thrustsnd=null,ufosnd=null,ufoBulletsnd=null,ufoShootingSpeed=1e3,ufoAim=50,ufoScale=.1,ufoMaxSpeed=3,ufoMinSpeed=1,ufoSizeVar=10,ufoTimer=null,screenScale=1;function animateScreen(t,s){hideCursor(),updateAsteroids(),checkUFO(),updateShots(s),updateUFOShot(),moveSpaceship(delta_time),updateSpaceship(delta_time),$("#scoreCnt span").html(score),$("#lifeCnt span").html(lifeCnt)}function hideCursor(){1==inPlay?$("#game__wrapper").addClass("cursorHide"):$("#game__wrapper").removeClass("cursorHide")}function updateAsteroids(){for(var t in asteroids){if(asteroids.hasOwnProperty(t))asteroids[t].changePosition(asteroids[t].x+asteroids[t].xv,asteroids[t].y+asteroids[t].yv),"asteroids"==mode&&((asteroids[t].x<=0-asteroids[t].width||asteroids[t].x>=xLimit+asteroids[t].width)&&(asteroids[t].x>=xLimit+asteroids[t].width?asteroids[t].x=-Math.abs(0-asteroids[t].width):asteroids[t].x=xLimit+asteroids[t].width),(asteroids[t].y<=0-asteroids[t].width||asteroids[t].y>=yLimit+asteroids[t].height)&&(asteroids[t].y>=yLimit+asteroids[t].height?asteroids[t].y=-Math.abs(0-asteroids[t].height):asteroids[t].y=yLimit+asteroids[t].height)),1==inPlay&&inCollision(asteroids[t])&&boom();$("#rockAnim"+asteroids[t].id).css("left",asteroids[t].x).css("top",asteroids[t].y)}}function checkUFO(){null!=ufo&&null!=ufo&&1==ufoActive&&(ufo.changePosition(ufo.x+ufo.vx,ufo.y+ufo.vy),ufo.x>xLimit+100&&(parkUfo(),spawnEnemy()),ufo.x<-60&&ufo.x>-199&&(parkUfo(),spawnEnemy()),$("#ufoShip").css("left",ufo.x).css("top",ufo.y))}function updateShots(t){for(var s in t){var e=10*Math.cos(t[s].theta*Math.PI/180)+t[s].x,i=10*Math.sin(t[s].theta*Math.PI/180)+t[s].y,o=t[s].life-5;t[s].changeLife(o),t[s].life<0?clearBullet("sp",s):(t[s].changePosition(e,i),$("#shot"+t[s].id).css("left",t[s].x).css("top",t[s].y),isHit(t[s])?clearBullet("sp",s):isUfoHit(t[s])&&clearBullet("sp",s))}}function updateUFOShot(){for(var t in ufoShots)thisUfoVX=10*Math.cos(ufoShots[t].theta*Math.PI/180)+ufoShots[t].x,thisUfoVY=10*Math.sin(ufoShots[t].theta*Math.PI/180)+ufoShots[t].y,thisUfoLife=ufoShots[t].life-5,ufoShots[t].changeLife(thisUfoLife),ufoShots[t].life<0?clearBullet("ufo",t):(ufoShots[t].changePosition(thisUfoVX,thisUfoVY),$("#ufoshot"+ufoShots[t].id).css("left",ufoShots[t].x).css("top",ufoShots[t].y),isSpaceshipHit(ufoShots[t])&&clearBullet("ufo",t))}function regenerateAsteroids(){for(scale=1,(rock_max_v+=.25)>=6&&(rock_max_v=6),i=0;i<rockCnt;i++)rockID++,thisRockSize=100,asteroids.push(new Asteroid(rockID,"test",thisRockSize/screenScale,thisRockSize/screenScale,getSafeRandomFloat(0,xLimit-150),getSafeRandomFloat(0,yLimit-150),getRandomFloat(-Math.abs(rock_max_v),rock_max_v),getRandomFloat(-Math.abs(rock_max_v),rock_max_v),colors[Math.floor(getRandomFloat(0,5))],"generic",!1,20,!0));for(var t in asteroids)asteroids.hasOwnProperty(t)&&($("body").append("<svg id='rockAnim"+asteroids[t].id+"' data-id='"+asteroids[t].id+"' class='asteroid rocksize100'><path cx='"+asteroids[t].width+"' cy='"+asteroids[t].height+"' r='"+(asteroids[t].width/2-5)+"' stroke='"+asteroids[t].color+"' stroke-width='2' d='M "+rocksLrg[Math.floor(getRandomFloat(0,3))]+" Z'  id='astroPath"+asteroids[t].id+"'  transform='scale("+scale/screenScale+", "+scale/screenScale+")' /><text x='20' y='55' fill='"+asteroids[t].color+"' transform='scale("+scale+", "+scale+")'></text></svg>"),$("#rockAnim"+asteroids[t].id).css("color",asteroids[t].color).css("border-color",asteroids[t].color).css("width",asteroids[t].width).css("height",asteroids[t].height).addClass("rockAnim"))}function makeAsteroidPieces(t,s,e,o){for(i=0;i<o;i++){switch(rockID++,thisRockSize=e,e){case 100:scale="1",maxVel=rock_max_v,rockPnt=20;break;case 50:scale=".5",maxVel=rock_max_v+1,rockPnt=50;break;case 25:scale=".25",maxVel=rock_max_v+2,rockPnt=100}asteroids.push(new Asteroid(rockID,"test",thisRockSize,thisRockSize,t,s,getRandomFloat(-Math.abs(maxVel),maxVel),getRandomFloat(-Math.abs(maxVel),maxVel),colors[Math.floor(getRandomFloat(0,5))],"generic",!1,rockPnt,!0)),$("body").append("<svg id='rockAnim"+asteroids[asteroids.length-1].id+"' data-id='"+asteroids[asteroids.length-1].id+"' class='asteroid rocksize"+e+"'><path cx='"+asteroids[asteroids.length-1].width+"' cy='"+asteroids[asteroids.length-1].height+"' r='"+(asteroids[asteroids.length-1].width/2-5)+"' stroke='"+asteroids[asteroids.length-1].color+"' stroke-width='2' d='M "+rocksLrg[Math.floor(getRandomFloat(0,3))]+" Z'  id='astroPath"+asteroids[asteroids.length-1].id+"' transform='scale("+scale+", "+scale+")' /><text x='20' y='55' fill='"+asteroids[asteroids.length-1].color+"' transform='scale("+scale+", "+scale+")></text></svg>"),$("#rockAnim"+asteroids[asteroids.length-1].id).css("color",asteroids[asteroids.length-1].color).css("border-color",asteroids[asteroids.length-1].color).css("width",asteroids[asteroids.length-1].width).css("height",asteroids[asteroids.length-1].height).addClass("rockAnim")}}function blowupAsteroid(t,s){$("#sndAstroBoom").get(0).pause(),$("#sndAstroBoom").get(0).currentTime=0,$("#sndAstroBoom").get(0).play();var e=t;pointCnt(t.points),e.height>25&&makeAsteroidPieces(e.x,e.y,e.height/2,2),$("#rockAnim"+e.id).remove(),e.destroy(),asteroids.splice(s,1),0==asteroids.length&&regenerateAsteroids()}function inCollision(t){var s=spaceship,e=t;return!(s.y+s.height<e.y||s.y>e.y+e.height||s.x+s.width<e.x||s.x>e.x+e.width)}function isHit(t){var s=asteroids,e=t;for(i=0;i<s.length;i++)if(0==(s[i].y+s[i].height<e.y||s[i].y>e.y+e.height||s[i].x+s[i].width<e.x||s[i].x>e.x+e.width))return blowupAsteroid(s[i],i),!0}function isSpaceshipHit(t){var s=spaceship,e=t;if(0==(s.y+s.height<e.y||s.y>e.y+e.height||s.x+s.width<e.x||s.x>e.x+e.width))return boom(),ufoActive=!1,!0}function isUfoHit(t){var s=ufo,e=t;if(0==(s.y+s.height<e.y||s.y>e.y+e.height||s.x+s.width<e.x||s.x>e.x+e.width))return blowupUfo(s,i),ufoActive=!1,!0}function resetSpaceship(){if(lifeCnt>0){for($("#spaceship").show(),$("#spaceship").css("opacity",".25"),spaceship=new Spaceship(xLimit/2,yLimit/2,0,0,-90,0,0,0),$("#spawn").css("left",spawnBox.x).css("top",spawnBox.y).css("height",spawnBox.height).css("width",spawnBox.width),parkUfo(),clearTimeout(ufoTimer),spawnEnemy();1==safeSpawn();)inPlay=!1,animateScreen();inPlay=!0,$("#spaceship").css("opacity","1")}else inPlay=!1,$("#spaceship").hide(),$("#gameOverBoard").css("display","flex"),checkHighScoreCookie()}function moveSpaceship(t){var s=Math.PI/180;0!=turn&&null!=turn?(spaceship.theta=spaceship.theta+turn*turn_per_milli*t,lifeCnt>0&&$("#sndTurn").get(0).play()):($("#sndTurn").get(0).pause(),$("#sndTurn").get(0).currentTime=0),0!=thrust&&null!=thrust?(del_vx=(del_v=thrust*thrust_per_milli*t)*Math.cos(spaceship.theta*s),del_vy=del_v*Math.sin(spaceship.theta*s),lifeCnt>0&&thrustsnd.play()):(del_vx=0,del_vy=0,thrustsnd.stop()),spaceship.vx=spaceship.vx+del_vx,spaceship.vy=spaceship.vy+del_vy}function updateSpaceship(t){spaceship.x>=xLimit&&(spaceship.x=0),spaceship.x<0&&(spaceship.x=xLimit),spaceship.y>=yLimit&&(spaceship.y=0),spaceship.y<0&&(spaceship.y=yLimit),spaceship.theta+=spaceship.yaw*t,spaceship.x+=spaceship.vx*t,spaceship.y+=spaceship.vy*t,$("#spaceship").css("left",spaceship.x).css("top",spaceship.y).css({transform:"rotate("+spaceship.theta+"deg)"})}function hyperspace(){lifeCnt>0&&1==inPlay&&(jumpCnt>0?($("#sndHyperspace").get(0).currentTime=0,$("#sndHyperspace").get(0).play(),spaceship.x=getRandomFloat(1,xLimit-5),spaceship.y=getRandomFloat(1,yLimit-5),spaceship.vx=0,spaceship.vy=0,jumpCnt--,$("#HSCnt span").html(jumpCnt)):$("#sndHyperspaceFail").get(0).play())}function makeShot(){shotCnt++,shots.push(new Shot(shotCnt,spaceship.x,spaceship.y,spaceship.vx,spaceship.vy,spaceship.theta,spaceship.yaw,1800,0,0)),$("body").append("<svg id='shot"+shotCnt+"' data-id='"+shotCnt+"' class='shot' height='6' width='6'><circle cx='3' cy='3' r='3' stroke='white' stroke-width='2' fill='red' /></svg>")}function boom(){$("#spaceship").hide(),spaceship.destroy(),inPlay=!1,ufoActive=!1,spaceship.x=-1e3,spaceship.y=-1e3,spaceship.vx=0,spaceship.vy=0,$("#sndBoom").get(0).play(),lifeCnt>0&&(lifeCnt--,$("#lifeCnt span").html(lifeCnt),jumpCnt=3,$("#HSCnt span").html(jumpCnt),setTimeout(function(){resetSpaceship()},3e3))}function pewpew(){lifeCnt>0&&1==resetGun&&1==inPlay&&(shootsnd.play(),makeShot(),resetGun=!1)}function spawnEnemy(){$("#ufoShip").remove();var t=Math.floor(1e3*getRandomFloat(25,60));ufoTimer=setTimeout(function(){makeUFO(!0,.1)},t)}function makeUFO(t,s){ufoActive=t;var e=Math.random()<.5?-1:1;ufo.x=e>0?0-ufo.width:xLimit+ufo.width,ufoSizeVar=Math.pow(Math.floor(10*Math.random()),2),--ufoAim<0&&(ufoAim=0);var i=s;ufo.y=getRandomFloat(0,yLimit),ufo.vx=getRandomFloat(1,ufoMaxSpeed)*e,(ufoMaxSpeed+=.25)>10&&(ufoMaxSpeed=10),ufo.points=200,(ufoSizeVar>75||score>=1e5)&&(i=.06,ufo.vx=getRandomFloat(3,10)*e,ufoAim=0,ufo.points=1e3),$("body").append("<svg id='ufoShip' class='ufo'><polygon transform='scale("+i+", "+i+")'  id='myPolygon' stroke='#ffffff'   stroke-width='15' points='466.697 275.189, 350.500 226.628, 329.099 170.984, 294.919 147.509, 242.500 147.509, 242.500 112.989, 235.000 105.489, 227.500 112.989, 227.500 147.509, 175.081 147.509, 140.901 170.984, 119.500 226.628, 3.303 275.189, 0.000 281.405, 3.303 287.621, 106.027 332.782, 143.504 364.510, 326.496 364.510, 363.973 332.782, 466.697 287.621, 470.000 281.405, 466.697 275.189'></svg>"),$("#ufoShip").css("width",ufo.width).css("height",ufo.height);var o=setInterval(function(){if(1==ufoActive&&1==inPlay){ufoShotCnt++;var t=180*Math.atan2(spaceship.y-ufo.y,spaceship.x-ufo.x)/Math.PI+getRandomFloat(-1*ufoAim,ufoAim);ufoShots.push(new Shot(ufoShotCnt,ufo.x,ufo.y,ufo.vx,ufo.vy,t,ufo.yaw,1800,0,0)),ufoBulletsnd.play(),.1==i?$("#sndSaucerBig").get(0).play():$("#sndSaucerSmall").get(0).play(),$("body").append("<svg id='ufoshot"+ufoShotCnt+"' data-id='"+ufoShotCnt+"' class='ufoshot' height='8' width='8'><circle cx='3' cy='3' r='3' stroke='white' stroke-width='2' fill='blue' /></svg>")}else clearInterval(o),.1==i?($("#sndSaucerBig").get(0).pause(),$("#sndSaucerBig").get(0).currentTime=0):($("#sndSaucerSmall").get(0).pause(),$("#sndSaucerSmall").get(0).currentTime=0)},ufoShootingSpeed)}function blowupUfo(t,s){$("#sndAstroBoom").get(0).pause(),$("#sndAstroBoom").get(0).currentTime=0,$("#sndAstroBoom").get(0).play(),$("#ufoShip").remove(),ufoBoom.play(),pointCnt(t.points),parkUfo(),clearTimeout(ufoTimer),spawnEnemy()}function parkUfo(){$("#ufoShip").remove(),ufoActive=!1,ufo.x=-200,ufo.y=-200,ufo.vx=0,ufo.vy=0}function resetWindowLimit(t){var s,e,o;if(e=window.innerHeight,o=window.innerHeight,"x"==t)for(s=window.innerWidth,i=0;i<asteroids.length;i++)asteroids[i].x>=e-asteroids[i].width&&asteroids[i].changePosition(e-asteroids[i].width,o-asteroids[i].height);else for(s=window.innerHeight,i=0;i<asteroids.length;i++)asteroids[i].y>=o-asteroids[i].height&&asteroids[i].changePosition(e-asteroids[i].width,s-asteroids[i].height);return s}function getRandomFloat(t,s){return Math.random()*(s-t)+t}function getSafeRandomFloat(t,s){var e=t+s/2,i=0;return Math.random()*(s-t)+t>=e&&(i=s),i}function clearBullet(t,s){"ufo"==t?($("#ufoshot"+ufoShots[s].id).remove(),ufoShots.splice(s,1)):($("#shot"+shots[s].id).remove(),shots.splice(s,1))}function safeSpawn(){var t=asteroids,s=spawnBox;for(i=0;i<t.length;i++)if(0==(t[i].y+t[i].height<s.y||t[i].y>s.y+s.height||t[i].x+t[i].width<s.x||t[i].x>s.x+s.width))return!0}function resetgame(){$("#gameOverBoard").hide(),$(".asteroid").remove(),lifeCnt=3,jumpCnt=3,score=0,newLife=newLifeTarget,ufoAim=50,asteroids=[],regenerateAsteroids(),$("body").append("<svg id='spaceship' class=''><path cx='5' cy='5' r='10' stroke='#ffffff' stroke-width='2' d='M "+spaceship.shape+" Z'  id='outerShip' /></svg>"),$("#lifeCnt span").html(lifeCnt),$("#HSCnt span").html(jumpCnt),resetSpaceship()}function pointCnt(t){score+=t,(newLife-=t)<0&&(lifeCnt++,newLife=newLifeTarget+newLife,playExtraLife())}function playExtraLife(){setTimeout(function(){extraLifesnd.play()},1),setTimeout(function(){extraLifesnd.play()},250),setTimeout(function(){extraLifesnd.play()},500)}function checkHighScoreCookie(){var t=localStorage.getItem("highScore-asteroids");""==t||null==t?(localStorage.setItem("highScore-asteroids",score),$("#highScore span").text(score)):t<=score?(localStorage.setItem("highScore-asteroids",score),$("#highScore span").text(score)):$("#highScore span").text(t)}xLimit<=414&&(screenScale=2,rockCnt=5),$(document).ready(function(){shootsnd=new Sound("snd/fire.mp3"),thrustsnd=new Sound("snd/thrust.mp3"),extraLifesnd=new Sound("snd/extraShip.ogg"),ufosnd=new Sound("snd/saucerBig.mp3"),ufoBulletsnd=new Sound("snd/laser.mp3"),ufoBoom=new Sound("snd/bangMedium.mp3"),resetgame(),xLimit>768&&(inPlay=!1,$("#welcomeModel").modal("show"),$("#welcomeModel").on("hidden.bs.modal",function(t){inPlay=!0}));setInterval(function(){animateScreen(asteroids,shots)},delta_time)}),lifeCnt>0&&(document.onkeydown=function(t){switch($("#spaceship").css("opacity","1"),t.keyCode){case 68:turn=2;break;case 65:turn=-2;break;case 87:thrust=1;break;case 83:thrust=-1;break;case 13:pewpew(),resetGun=!1;break;case 32:hyperspace();break;case 8:case 46:boom()}},document.onkeyup=function(t){switch(t.keyCode){case 65:case 68:turn=0;break;case 87:case 83:thrust=0;break;case 13:resetGun=!0}},$(document).on("touchstart"," .gameBtn",function(t){$("#spaceship").css("opacity","1");var s=t.target.id;switch(console.log(s),s){case"btnLeft":turn=-1;break;case"btnRight":turn=1;break;case"btnUp":thrust=1;break;case"btnDown":thrust=-1;break;case"btnShoot":pewpew();break;case"btnHS":hyperspace()}}),$(document).on("touchend",".gameBtn",function(t){switch(t.target.id){case"btnLeft":case"btnRight":turn=0;break;case"btnUp":case"btnDown":thrust=0;break;case"glyphLeft":turn=0;break;case"btnShoot":resetGun=!0}})),$(window).resize(function(){xLimit=resetWindowLimit("x"),yLimit=resetWindowLimit("y")});