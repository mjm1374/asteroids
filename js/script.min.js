var asteroids=[],rocksLrg=["M 26.087899,1.0434852 49.503787,26.009091 74.220561,2.6541843 96.335572,25.203747 85.278067,50.974686 98.286898,75.940275 62.512619,99.295186 26.087905,100.10053 0.7206885,77.55096 1.3711312,27.619771 Z","M 27.46638,2.6445482 66.467442,0.98983643 99.048213,24.999426 V 35.822504 L 65.202598,51.325844 98.421452,73.55696 76.484471,97.835645 H 72.723845 L 60.501821,85.842551 27.596351,98.713169 0.95859607,63.02645 1.8987487,25.29194 H 36.997914 Z","M 14.670645,48.844427 1.9670478,25.614646 27.37424,2.3848478 48.335078,12.875719 73.107033,1.6354928 97.878992,24.865291 75.012591,39.102909 97.878992,60.834007 75.012591,97.552066 39.442599,87.061197 26.739004,99.050766 1.3318868,75.820971 Z"];for(xLimit=resetWindowLimit("x")-1,yLimit=resetWindowLimit("y")-1,lifeCnt=3,jumpCnt=3,score=0,mode="asteroids",rockCnt=10,delta_time=20,turn=0,thrust=0,turn_per_milli=.1,thrust_per_milli=15e-5,key_delay=50,del_v=0,del_vx=0,del_vy=0,spaceship=new Spaceship(xLimit/2,yLimit/2,0,0,0,0,0,0),colors=["#edc951","#eb6841","#cc2a36","#4f372d","#00a0b0"],i=0;i<rockCnt;i++)thisRockSize=Math.floor(getRandomFloat(50,100)),thisRockSize=100,asteroids.push(new Asteroid(i,"test",thisRockSize,thisRockSize,getRandomFloat(0,xLimit-150),getRandomFloat(0,yLimit-150),getRandomFloat(-3,3),getRandomFloat(-3,3),colors[Math.floor(getRandomFloat(0,5))],"generic",!1));function resetWindowLimit(t){var e,s,o;if(s=window.innerHeight,o=window.innerHeight,"x"==t)for(e=window.innerWidth,i=0;i<asteroids.length;i++)asteroids[i].xcord>=s-asteroids[i].width&&asteroids[i].changePosition(s-asteroids[i].width,o-asteroids[i].height);else for(e=window.innerHeight,i=0;i<asteroids.length;i++)asteroids[i].ycord>=o-asteroids[i].height&&asteroids[i].changePosition(s-asteroids[i].width,e-asteroids[i].height);return e}function animateScreen(t){var i=t;for(var e in $("#scoreCnt span").html(score),i){if(i.hasOwnProperty(e))i[e].changePosition(i[e].xcord+i[e].xvel,i[e].ycord+i[e].yvel),"asteroids"==mode&&((i[e].xcord<=0-i[e].width||i[e].xcord>=xLimit+i[e].width)&&(i[e].xcord>=xLimit+i[e].width?i[e].xcord=-Math.abs(0-i[e].width):i[e].xcord=xLimit+i[e].width),(i[e].ycord<=0-i[e].width||i[e].ycord>=yLimit+i[e].height)&&(i[e].ycord>=yLimit+i[e].height?i[e].ycord=-Math.abs(0-i[e].height):i[e].ycord=yLimit+i[e].height));$("#rockAnim"+i[e].id).css("left",i[e].xcord).css("top",i[e].ycord)}!function(t){var i=Math.PI/180;0!=turn&&void 0!=turn?(spaceship.theta=spaceship.theta+turn*turn_per_milli*t,lifeCnt>0&&$("#sndTurn").get(0).play()):($("#sndTurn").get(0).pause(),$("#sndTurn").get(0).currentTime=0),0!=thrust&&void 0!=thrust?(del_v=thrust*thrust_per_milli*t,del_vx=del_v*Math.cos(spaceship.theta*i),del_vy=del_v*Math.sin(spaceship.theta*i),lifeCnt>0&&$("#sndPlayer").get(0).play()):(del_vx=0,del_vy=0,$("#sndPlayer").get(0).pause(),$("#sndPlayer").get(0).currentTime=0),spaceship.vx=spaceship.vx+del_vx,spaceship.vy=spaceship.vy+del_vy}(delta_time),function(t){spaceship.x>=xLimit&&(spaceship.x=0),spaceship.x<0&&(spaceship.x=xLimit),spaceship.y>=yLimit&&(spaceship.y=0),spaceship.y<0&&(spaceship.y=yLimit),spaceship.theta+=spaceship.yaw*t,spaceship.x+=spaceship.vx*t,spaceship.y+=spaceship.vy*t,$("#spaceship").css("left",spaceship.x).css("top",spaceship.y).css({transform:"rotate("+spaceship.theta+"deg)"})}(delta_time)}function getRandomFloat(t,i){return Math.random()*(i-t)+t}function boom(){lifeCnt>0&&(lifeCnt--,$("#lifeCnt span").html(lifeCnt),jumpCnt=3,$("#HSCnt span").html(jumpCnt),resetSpaceship())}function resetSpaceship(){lifeCnt>0?spaceship=new Spaceship(xLimit/2,yLimit/2,0,0,0,0,0,0):($("#spaceship").hide(),$("#gameover").css("display","block"))}function hyperspace(){jumpCnt>0?($("#sndHyperspace").get(0).currentTime=0,$("#sndHyperspace").get(0).play(),spaceship.x=getRandomFloat(1,xLimit-5),spaceship.y=getRandomFloat(1,yLimit-5),jumpCnt--,$("#HSCnt span").html(jumpCnt)):$("#sndHyperspaceFail").get(0).play()}function pewpew(){lifeCnt>0&&$("#sndLaser").get(0).play()}function endpew(){$("#sndLaser").get(0).pause(),$("#sndLaser").get(0).currentTime=0}function Asteroid(t,i,e,s,o,a,r,h,n,c,d){this.id=t,this.title=i,this.width=e,this.height=s,this.xcord=o,this.ycord=a,this.xvel=r,this.yvel=h,this.color=n,this.type=c,this.oob=d,this.gravity=.1,this.gravitySpeed=0,this.bounce=.4,this.resetGravity=function(){},this.newPos=function(){this.gravitySpeed+=this.gravity,this.xcord+=this.xvel;var t=this.yvel;this.yvel<0&&(t=0),t=0,this.ycord+=t+this.gravitySpeed,this.hitBottom()},this.hitBottom=function(){var t=window.innerHeight-this.height;this.ycord>t&&(this.ycord=t,this.gravitySpeed=-this.gravitySpeed*this.bounce),this.xcord>window.innerWidth+this.width&&(this.xcord=0-this.width),this.xcord<0-this.width&&(this.xcord=window.innerWidth+this.width)},this.changeColor=function(t){this.color=t},this.oob=function(t){this.oob=t},this.changeVelocity=function(t,i){"x"==t&&(this.xvel=i),"y"==t&&(this.yvel=i)},this.changePosition=function(t,i){this.xcord=t,this.ycord=i},this.getVelocity=function(t){return this.direction}}function Spaceship(t,i,e,s,o,a,r,h){this.x=t,this.y=i,this.vx=e,this.vy=s,this.theta=o,this.yaw=a,this.x_points=r,this.y_points=h,this.shape="M 14.383032,5.9181762 0.35137621,0.04626516 2.7568063,5.9181762 0.35137621,11.338401 Z"}lifeCnt>0&&(document.onkeydown=function(t){switch(t.keyCode){case 68:turn=1;break;case 65:turn=-1;break;case 87:thrust=1;break;case 83:thrust=-1;break;case 32:pewpew();break;case 13:hyperspace();break;case 8:case 46:boom()}},document.onkeyup=function(t){switch(t.keyCode){case 65:case 68:turn=0;break;case 87:case 83:thrust=0;break;case 32:endpew()}},$(document).on("touchstart"," .gameBtn",function(t){var i=t.target.id;switch(console.log(i),i){case"btnLeft":turn=-1;break;case"btnRight":turn=1;break;case"btnUp":thrust=1;break;case"btnDown":thrust=-1;break;case"btnShoot":case"glyphShoot":pewpew();break;case"btnHS":hyperspace()}}),$(document).on("touchend",".gameBtn",function(t){switch(t.target.id){case"btnLeft":case"btnRight":turn=0;break;case"btnUp":case"btnDown":thrust=0;break;case"glyphLeft":case"glyphRight":turn=0;break;case"glyphUp":case"glyphDown":thrust=0;break;case"btnShoot":case"glyphShoot":endpew()}})),$(document).ready(function(){for(var t in $("#lifeCnt span").html(lifeCnt),$("#HSCnt span").html(jumpCnt),asteroids)asteroids.hasOwnProperty(t)&&($("body").append("<svg id='rockAnim"+asteroids[t].id+"' data-id='"+asteroids[t].id+"' class='clicker'><path cx='"+asteroids[t].width+"' cy='"+asteroids[t].height+"' r='"+(asteroids[t].width/2-5)+"' stroke='"+asteroids[t].color+"' stroke-width='2' d='"+rocksLrg[Math.floor(getRandomFloat(0,3))]+"'  id='path81' /><text x='20' y='55' fill='"+asteroids[t].color+"'>"+asteroids[t].id+"</text></svg>"),$("#rockAnim"+asteroids[t].id).css("color",asteroids[t].color).css("border-color",asteroids[t].color).css("width",asteroids[t].width).css("height",asteroids[t].height).addClass("rockAnim"));$("body").append("<svg id='spaceship' class=''><path cx='5' cy='5' r='10' stroke='#ffffff' stroke-width='2' d='"+spaceship.shape+"'  id='outerShip' /></svg>"),$("#welcomeModel").modal("show"),$(".cntrlButton").click(function(){if(mode=$(this).data("mode"),"asteroids"==mode)for(var t in asteroids)(asteroids[t].xcord<=0||asteroids[t].xcord>=xLimit-asteroids[t].width||asteroids[t].ycord<=0||asteroids[t].ycord>=yLimit-asteroids[t].height)&&(asteroids[t].oob=!0)}),$(".clicker").click(function(){var t=$(this).data("id");console.log(asteroids[t].id+": "+asteroids[t].xvel+" - "+asteroids[t].yvel)});setInterval(function(){animateScreen(asteroids)},delta_time)}),$(window).resize(function(){xLimit=resetWindowLimit("x"),yLimit=resetWindowLimit("y")});